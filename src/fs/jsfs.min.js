(function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e=[].slice,r={}.hasOwnProperty,i=[].indexOf||function(t){for(var e=0,r=this.length;e<r;e++)if(e in this&&this[e]===t)return e;return-1};window.FileSystem=function(){function n(e){this.rm=t(this.rm,this),this.type=t(this.type,this),this.walkPathAndFile=t(this.walkPathAndFile,this),this.separateWithFilename=t(this.separateWithFilename,this),this._name=""+e||"undefined",this._getFilesystemObject(),this._cwd=FileSystem.prototype.pathSeparator,this.compressionDefault=!1}var a;return n.prototype.pathSeparator="/",n.prototype.escapeCharacter="\\",n.prototype._storageName=function(){return""+this._name+"_filesystem"},n.prototype._fileName=function(t){return""+this._name+"_file_"+t},n.prototype._getFilesystemObject=function(){var t;return t=JSON.parse(localStorage.getItem(this._storageName())),null===t&&this._setFilesystemObject(t={}),t},n.prototype._setFilesystemObject=function(t){var e;try{return localStorage.setItem(this._storageName(),JSON.stringify(t)),!0}catch(r){return e=r,!1}},n.prototype._readFile=function(t){var e;if(e=localStorage.getItem(this._fileName(t[0])),t[2]){if("undefined"==typeof LZString||null===LZString)throw Error("Cannot decompress file; LZString undefined");e=LZString.decompress(e)}return JSON.parse(e)},n.prototype._writeFile=function(t,e){var r;if(r=JSON.stringify(e),t[2]){if("undefined"==typeof LZString||null===LZString)throw Error("Cannot compress file; LZString undefined");r=LZString.compress(r)}return localStorage.setItem(this._fileName(t[0]),r),t[1]=r.length},n.prototype._removeFile=function(t){return localStorage.removeItem(this._fileName(t[0]))},n.prototype.getName=function(){return this._name},n.prototype.getCwd=function(){return this._cwd},a=function(){var t,r,i,n,a,o,s;for(n=arguments[0],a=2<=arguments.length?e.call(arguments,1):[],i="";n.length>0;){for(t=!1,r=o=0,s=a.length-1;o<s;r=o+=2)if(n.slice(0,a[r].length)===a[r]){i+=a[r+1],n=n.slice(a[r].length),t=!0;break}t||(i+=n[0],n=n.slice(1))}return i},n.prototype._splitPath=function(t){var e,r,i,n,o,s,l,h;for(n=FileSystem.prototype.pathSeparator,r=FileSystem.prototype.escapeCharacter,i=t.indexOf(n+n);i>-1;)t=t.slice(0,i)+t.slice(i+n.length),i=t.indexOf(n+n);for(t.slice(0,n.length)===n&&(t=t.slice(n.length)),t.slice(-n.length)===n&&(t=t.slice(0,-n.length)),l=a(t,r+n,n,r+r,r,n,"\n").split("\n"),h=[],o=0,s=l.length;o<s;o++)e=l[o],""!==e&&h.push(e);return h},n.prototype._joinPath=function(t){var e,r,i;return i=FileSystem.prototype.pathSeparator,e=FileSystem.prototype.escapeCharacter,function(){var n,o,s;for(s=[],n=0,o=t.length;n<o;n++)r=t[n],s.push(a(r,i,e+i,e,e+e));return s}().join(i)},n.prototype._toAbsolutePath=function(t,e){var r,i;return null==e?t:(i=FileSystem.prototype.pathSeparator,e.slice(0,i.length)===i?e:(r=FileSystem.prototype._joinPath(FileSystem.prototype._splitPath(t).concat(FileSystem.prototype._splitPath(e))),r.slice(0,i.length)!==i&&(r=i+r),r))},n.prototype._toCanonicalPath=function(t){var e,r,i,n,a,o;for(e=[],o=FileSystem.prototype._splitPath(t),n=0,a=o.length;n<a;n++)i=o[n],"."!==i&&(".."===i?e.length>0&&e.pop():e.push(i));return e=FileSystem.prototype._joinPath(e),r=FileSystem.prototype.pathSeparator,e.slice(0,r.length)!==r&&(e=r+e),e},n.prototype._isValidCanonicalPath=function(t){var e,r,i,n,a;for(e=FileSystem.prototype._splitPath(t),i=this._getFilesystemObject(),n=0,a=e.length;n<a;n++)if(r=e[n],i=i[r],!i||i instanceof Array)return!1;return!0},n.prototype.separate=function(t){return FileSystem.prototype._splitPath(FileSystem.prototype._toCanonicalPath(FileSystem.prototype._toAbsolutePath(this._cwd,t)))},n.prototype.separateWithFilename=function(t){var e;return e=this.separate(t),{path:e.slice(0,-1),name:e[e.length-1]}},n.prototype.walkPath=function(t,e){var r,i,n;for(i=0,n=e.length;i<n;i++){if(r=e[i],!t.hasOwnProperty(r)||t[r]instanceof Array)return null;t=t[r]}return t},n.prototype.walkPathAndFile=function(t,e){return 0===e.length?t:(t=this.walkPath(t,e.slice(0,-1)),t?t[e[e.length-1]]||null:null)},n.prototype.type=function(t){var e,r;return r=this.separate(t),e=this.walkPathAndFile(this._getFilesystemObject(),r),e?e instanceof Array?"file":"folder":null},n.prototype.cd=function(t){var e;if(null==t&&(t=FileSystem.prototype.pathSeparator),e=FileSystem.prototype._toCanonicalPath(FileSystem.prototype._toAbsolutePath(this._cwd,t)),this._isValidCanonicalPath(e))return this._cwd=e},n.prototype.mkdir=function(t){var e,r,i,n,a,o,s;for(null==t&&(t="."),n=r=this._getFilesystemObject(),e=!1,s=this.separate(t),a=0,o=s.length;a<o;a++)i=s[a],n.hasOwnProperty(i)||(n[i]={},e=!0),n=n[i];return e&&this._setFilesystemObject(r)},n.prototype.ls=function(t,e){var i,n,a,o;if(null==t&&(t="."),null==e&&(e="all"),o=this.separate(t),t=this.walkPath(this._getFilesystemObject(),o),!t)throw Error("Invalid folder");return"all"!==e&&"files"!==e||(n=function(){var e;e=[];for(i in t)r.call(t,i)&&t[i]instanceof Array&&e.push(i);return e}(),n.sort(),"files"!==e)?(a=function(){var e;e=[];for(i in t)r.call(t,i)&&(t[i]instanceof Array||e.push(i));return e}(),a.sort(),"all"===e?a.concat(n):a):n},n.prototype._nextAvailableFileNumber=function(){var t,e,n,a,o,s,l,h,p;for(e=[],t=s=0,h=localStorage.length;0<=h?s<h:s>h;t=0<=h?++s:--s)e.push(localStorage.key(t));if(n=[],o=function(t){return function(e){var i,a;null==e&&(e=t._getFilesystemObject());for(i in e)r.call(e,i)&&(a=e[i],a instanceof Array?n.push(a[0]):n=n.concat(o(a)));return n}}(this),a=o().sort(function(t,e){return t-e}),0===a.length)return 0;for(t=l=0,p=a[a.length-1]+1;0<=p?l<=p:l>=p;t=0<=p?++l:--l)if(i.call(a,t)<0)return t},n.prototype.write=function(t,e,r){var i,n,a,o,s,l,h,p;if(null==r&&(r=this.compressionDefault),p=this.separateWithFilename(t),l=p.path,s=p.name,o=this._getFilesystemObject(),n=this.walkPath(o,l),!n)throw Error("Invalid folder path");if(n.hasOwnProperty(s)){if(!(n[s]instanceof Array))throw Error("Cannot write to a folder");i=n[s],a=this._readFile(i)}else i=[this._nextAvailableFileNumber(),0],a=null;return h=i[2],i[2]=r,this._writeFile(i,e),n[s]=i,this._setFilesystemObject(o)?i[1]:(i[2]=h,a?this._writeFile(i,a):this._removeFile(i),!1)},n.prototype.read=function(t){var e;if(e=this.walkPathAndFile(this._getFilesystemObject(),this.separate(t)),!e)throw Error("No such file");return this._readFile(e)},n.prototype.size=function(t){var e;return e=this.walkPathAndFile(this._getFilesystemObject(),this.separate(t)),(null!=e?e[1]:void 0)||-1},n.prototype.append=function(t,e,r){var i,n,a,o,s,l,h,p;if(null==r&&(r=this.compressionDefault),"string"!=typeof e)throw Error("Can only append strings to a file");if(p=this.separateWithFilename(t),l=p.path,s=p.name,o=this._getFilesystemObject(),n=this.walkPath(o,l),!n)throw Error("Invalid folder path");if(n.hasOwnProperty(s)){if(!(n[s]instanceof Array))throw Error("Cannot append to a folder");if(i=n[s],a=this._readFile(i),"string"!=typeof a)throw Error("Cannot append to a file unless it contains a string");e=a+e}else i=[this._nextAvailableFileNumber(),0],a=null;return h=i[2],i[2]=r,this._writeFile(i,e),n[s]=i,this._setFilesystemObject(o)?i[1]:(i[2]=h,a?this._writeFile(i,a):this._removeFile(i),!1)},n.prototype.rm=function(t){var e,i,n,a,o,s,l,h,p;if(h=this.separateWithFilename(t),t=h.path,o=h.name,!o)return!1;if(a=this._getFilesystemObject(),n=this.walkPath(a,t),!n)return!1;if(!n.hasOwnProperty(o))return!1;for(i=function(t){var e,n;if(t instanceof Array)return[t];n=[];for(e in t)r.call(t,e)&&(n=n.concat(i(t[e])));return n},p=i(n[o]),s=0,l=p.length;s<l;s++)e=p[s],this._removeFile(e);return delete n[o],this._setFilesystemObject(a),!0},n.prototype.cp=function(t,e){var r,i,n,a,o,s,l,h,p,f,c;if(s=this._getFilesystemObject(),f=this.separate(t),o=this.walkPathAndFile(s,f),!(o&&o instanceof Array))return!1;if(c=this.separateWithFilename(e),p=c.path,l=c.name,i=this.walkPath(s,p)){if(l){if(i.hasOwnProperty(l)){if(i[l]instanceof Array)return;if(i=i[l],l=f[f.length-1],i.hasOwnProperty(l))return}}else n=sourceName;r=this._readFile(o),h=[this._nextAvailableFileNumber(),0];try{this._writeFile(h,r)}catch(u){return a=u,!1}return i[l]=h,!!this._setFilesystemObject(s)||(this._removeFile(h),!1)}},n.prototype.mv=function(t,e){var r,i,n,a,o,s,l,h,p;if(n=this._getFilesystemObject(),h=this.separateWithFilename(t),o=h.path,a=h.name,s=this.walkPath(n,o),!s||!s.hasOwnProperty(a))throw Error("No such file or folder");if(l=a,p=this.separateWithFilename(e),o=p.path,a=p.name,r=this.walkPath(n,o),i=a,r){if(a){if(r.hasOwnProperty(a)){if(r[i]instanceof Array)return;if(r=r[i],i=l,r.hasOwnProperty(i))return}}else i=l;return r[i]=s[l],delete s[l],this._setFilesystemObject(n)}},n}()}).call(this);
//# sourceMappingURL=jsfs.min.js.map